# =============================================================================
#           *** ุจูุช COSMOS ููุฃูุนุงุจ - ุงูุฅุตุฏุงุฑ 1.2 ***
#
#  (ูุฐุง ููุฏ ุงุฎุชุจุงุฑ ุจุณูุท ุฌุฏุงู ููุชุฃูุฏ ูู ุฃู ุชูููุฌุฑุงู ูุนูู)
# =============================================================================

import requests
import os
import sys

# --- [1] ุงูุฅุนุฏุงุฏุงุช ูุงูููุงุชูุญ ุงูุณุฑูุฉ ---
try:
    BOT_TOKEN = os.environ['BOT_TOKEN']
    CHANNEL_USERNAME = os.environ['CHANNEL_USERNAME'] 
except KeyError as e:
    print(f"!!! ุฎุทุฃ: ูุชุบูุฑ ุงูุจูุฆุฉ ุงูุฃุณุงุณู ุบูุฑ ููุฌูุฏ: {e}")
    print("!!! ูุฑุฌู ุงูุชุฃูุฏ ูู ุฅุถุงูุฉ BOT_TOKEN ู CHANNEL_USERNAME ุฅูู GitHub Secrets ูู 'ูุฐุง ุงููุณุชูุฏุน ุงูุฌุฏูุฏ'")
    sys.exit(1) # (ุฅููุงู ุงูุชุดุบูู ุจูุดู)

TELEGRAM_API_URL = f"https://api.telegram.org/bot{BOT_TOKEN}"

# --- [2] ุฏุงูุฉ ุฅุฑุณุงู ุงููุต ---
def post_text_to_telegram(text_content):
    print(f"... ุฌุงุฑู ุฅุฑุณุงู (ุฑุณุงูุฉ ุงูุงุฎุชุจุงุฑ) ุฅูู {CHANNEL_USERNAME} ...")
    url = f"{TELEGRAM_API_URL}/sendMessage"
    payload = { 'chat_id': CHANNEL_USERNAME, 'text': text_content, 'parse_mode': 'Markdown' }
    
    try:
        response = requests.post(url, json=payload, timeout=60)
        response.raise_for_status() # (ุณูุทุจุน ุฎุทุฃ ุฅุฐุง ูุดู)
        print(">>> ๐๐๐ ุชู ุฅุฑุณุงู (ุฑุณุงูุฉ ุงูุงุฎุชุจุงุฑ) ุจูุฌุงุญ! ๐๐๐")
    except requests.exceptions.RequestException as e:
        print(f"!!! ูุดู ุฅุฑุณุงู (ุฑุณุงูุฉ ุงูุงุฎุชุจุงุฑ): {e}")
        # (ุทุจุงุนุฉ ุฑุฏ ุชูููุฌุฑุงู ููุฑู ุงูุฎุทุฃ 400 ุฃู 404)
        print(f"!!! ุชูุงุตูู ุงูุฎุทุฃ ูู ุชูููุฌุฑุงู: {getattr(response, 'text', 'ูุง ููุฌุฏ ุฑุฏ')}")
        sys.exit(1) # (ุฅููุงู ุงูุชุดุบูู ุจูุดู)

# --- [3] ุงูุชุดุบูู ุงูุฑุฆูุณู ---
def main():
    print("==========================================")
    print(f"ุจุฏุก ุชุดุบูู (v1.2 - ุงุฎุชุจุงุฑ ุชูููุฌุฑุงู)...")
    
    test_message = (
        f"**ุงุฎุชุจุงุฑ (ุจูุช ุงูุฃูุนุงุจ v1.2)** ๐ฎ\n\n"
        f"ุฅุฐุง ุฑุฃูุช ูุฐู ุงูุฑุณุงูุฉุ ููุฐุง ูุนูู ุฃู `BOT_TOKEN` ู `CHANNEL_USERNAME` ูู ูุฐุง ุงููุณุชูุฏุน **ุตุญูุญุฉ 100%**."
    )
    
    post_text_to_telegram(test_message)
    
    print("... ุงูุชูุช ูููุฉ ุงูุงุฎุชุจุงุฑ.")
    print("==========================================")

if __name__ == "__main__":
    main()
